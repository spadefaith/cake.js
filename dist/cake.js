(()=>{var P=(T,m)=>()=>(m||T((m={exports:{}}).exports,m),m.exports);var N=P(()=>{(function(T){T.env={destructure:!0};let m=T.env;try{let{a}={a:!0}}catch{m.destructure=!1}Promise.prototype.ObjectType="Promise"})(window)});var M=P(()=>{Object.keys||(Object.keys=function(T){var m=[];for(var a in T)T.hasOwnProperty(a)&&m.push(a);return m})});var H=P(()=>{(function(T){let m={typeof:function(e){switch(!0){case typeof e=="string":return"string";case typeof e=="number":return"number";case e instanceof Array:return"array";case e instanceof Function:return"function";case e instanceof HTMLCollection:return"htmlcollection";case e instanceof NodeList:return"htmlnodelist";case e instanceof Element:return"domlement";case e instanceof Object:return"object"}},isArray:function(e){return this.typeof(e)=="array"},isObject:function(e){return this.typeof(e)=="object"},isNumber:function(e){return this.typeof(e)=="number"},isString:function(e){return this.typeof(e)=="string"},isHTMLCollection:function(e){return this.typeof(e)=="htmlcollection"},isNodeList:function(e){return this.typeof(e)=="htmlnodelist"},isElement:function(e){return this.typeof(e)=="domlement"},isFunction:function(e){return this.typeof(e)=="function"}},a={each:function(e,t,n){if(n=="object"){let i=0;for(let u in e)e.hasOwnProperty(u)&&(t({key:u,value:e[u]},i),i=i+1)}else for(let i=0;i<e.length;i++)t(e[i],i)},map:function(e,t){let n=m.isArray(e)||e.length?"array":"object",i=e.length&&n=="array"?[]:{};return this.each(e,function(u,r){let s=t(u,r);n=="object"?i[s.key]=s.value:i.push(s)},n),i},reduce:function(e,t,n){let i=m.typeof(e);return this.each(e,function(u,r){t=n(u,t,r)},i),t},filter:function(e,t){let n=m.isArray(e)||e.length?"array":"object",i=e.length&&n=="array"?[]:{};return this.each(e,function(u,r){t(u,r)&&(n=="object"?i[u.key]=u.value:i.push(u.value))},n),i}},c={perf:function(e){console.time("test"),e(),console.timeEnd("test")}};try{T.UTILS={...a,...m,...c}}catch{T.UTILS={};let t=a.each;t(a,function(n,i){T.UTILS[n]=i}),t(m,function(n,i){T.UTILS[n]=i}),t(c,function(n,i){T.UTILS[n]=i})}})(window)});var R=P(()=>{(function(T){HTMLCollection.prototype.toArray=function(){let m=[];for(let a=0;a<this.length;a++)m[a]=this[a];return m},NodeList.prototype.toArray=function(){let m=[],a=-1,c=this.length;for(;++a<c;)m[a]=this[a];return m},Object.cache=Object.create(null),String.prototype.toHyphen=function(){let m=Object.cache,a=null,c=this;if(m.toHyphen||(m.toHyphen={}),m[c]&&(a=m[c]),a!=null)return a;let e=c.split(""),t="",n=-1;for(;++n<e.length;){let i=e[n];switch(n){case 0:t+=i.toLowerCase();break;default:i.charCodeAt()<91&&(t+="-"),t+=i.toLowerCase()}}return m[c]=t,a=t,a},String.prototype.toCamelCase=function(){let m=this.toLowerCase(),a=Object.cache,c=null;switch(!0){case!a.toCamel:a.toCamel={};case!0:a=a.toCamel;case a[m]:c=a[m];break;default:{let e=m.split("-");if(e.length==1)return m;let t="",n=-1,i=e.length;for(;++n<i;){let u=e[n];switch(n){case 0:t+=u;default:{let r=u.substring(0,1).toUpperCase(),s=u.substring(1);t+=r+s}break}}a[m]=t,c=t}break}return c},HTMLElement.prototype.querySelectorIncluded=function(m,a,c){let e=this.querySelector(m);return e||(()=>{switch(!0){case(!a&&!c):{let t=this.closest(m);t==this&&(e=t)}break;case(!!a&&!!c):e=this.getAttribute(a)==c?this:null;break;case(!!a&&!c):e=this.getAttribute(a)?this:null;break}return e})()},HTMLElement.prototype.querySelectorAllIncluded=function(m,a,c){let e=this.querySelectorAll(m).toArray();switch(!0){case(!a&&!c):{let t=this.closest(m);t==this&&e.push(t)}break;case(a&&c):this.getAttribute(a)==c&&e.push(this);break;case(a&&!c):this.getAttribute(a)&&e.push(this);break}return e},HTMLDocument.prototype.querySelectorIncluded=function(m){return this.querySelector(m)},HTMLDocument.prototype.querySelectorAllIncluded=function(m){return this.querySelectorAll(m)},Array.prototype.toggler=function(m,a){for(let c=0;c<this.length;c++){let e=this[c];(e.dataset.name==m||e.classList.contains(a))&&e.classList.toggle(a)}},HTMLElement.prototype.Ref=function(){let m="_cakes_storage";!this[m]&&(this._cakes_storage={});let a=this[m];return{set(c,e){a[c]=e},get(c){return a[c]},getAll(c){return a},remove(c){delete a[c]}}}})(window)});var U=P(()=>{(function(){customElements.define("sub-template",class extends HTMLElement{constructor(){super()}connectedCallback(){this.replace(this)}replace(T){let m=T.dataset.template,a=document.getElementsByName(m);if(a.length>1){console.error(`template with name ${m} has more than one reference.`);return}if(!a)throw T.remove(),new Error(`${m} is not found!`);if(a[0]){let c=a[0];if(c.constructor.name=="HTMLTemplateElement"){if(c=c.content.cloneNode(!0).firstElementChild,!c)return;let e=T.attributes;for(let t=0;t<e.length;t++){let n=e[t];n.name!="data-template"&&c.setAttribute(n.name,n.value)}T.replaceWith(c)}else throw new Error(`${m} is not referred to a Template Element!`)}}}),HTMLTemplateElement.prototype.replaceSubTemplate=function(T){let m=T.getElementsByTagName("sub-template");if(m){m=m.toArray();for(let a=0;a<m.length;a++){let c=m[a];customElements.get("sub-template").prototype.replace(c)}}},HTMLTemplateElement.prototype.collectContent=function(){let T=this,m=null,a=T.cloneNode(!0),c=document.createDocumentFragment(),e=a.content.querySelector("style");e&&c.appendChild(e);let t=[];for(let n=0;n<a.content.children.length;n++){let i=a.content.children[0];this.replaceSubTemplate(i),t.push(i)}return m={style:c.children[0],others:t},m},HTMLTemplateElement.prototype.parseStyle=function(T){if(!T)return!1;var m=T.textContent;if(m=m.replace(/\s/g,""),!m.length)return;let a=!1,c=!1,e=!1,t=m.split(""),n="";m="";var i=!1;for(let u=0;u<t.length;u++){let r=t[u];r=="{"&&(a=!0,c=!0),r=="}"&&(a=!1,c=!1),!a&&r!="	"&&r!="}"&&r!=" "&&r!=";"&&(n+=r),c&&r!="	"&&r!="{"&r!=" "&&(m+=r),r=="}"&&(i||(i={}),i[n]=m,n="",m="")}return i},HTMLTemplateElement.prototype.parseHTML=function(T){if(T){var m=document.createElement("HTML");for(let a=0;a<T.length;a++){let c=T[a];m.append(c)}}return m||!1},HTMLTemplateElement.prototype.getContent=function(T){let{style:m,others:a}=this.collectContent(),c=this.parseStyle(m),e=this.parseHTML(a);for(let t in c)if(c.hasOwnProperty(t)){let n=e.querySelectorAll(t),i=c[t];for(let u=0;u<n.length;u++)n[u].setAttribute("style",i)}return e=T?e.children.toArray():e.innerHTML,e.length==1?e[0]:e}})()});var B=P(()=>{(function(T){function m(h){return h.constructor.name.toLowerCase()}function a(h,p){for(let g in h)h.hasOwnProperty(g)&&p(h[g],g)}function c(h,p,g){h=Object.assign(h,{[g]:p})}function e(h){return h===null}function t(h){return h===void 0}function n(h){return m(h)=="array"}function i(h){return m(h)=="object"}var u=function(h,p){for(var g=null,b=0;b<h.length;b++){var v=h[b];if(m(p)=="object"){var w=p,_=Object.keys(p)[0],O=w[_];if(m(v)=="object"){var S=v[_]==O;if(S){g=b;break}}}else if(m(p)!="array"){var S=p==v;if(S){g=b;break}}}return g},r=function(h,p){var g=null,b=m(p);if(b=="object"){var v=Object.keys(p)[0];h[g]!=null&&h[g]==p[v]&&(g=v)}else b=="string"&&(g=p);return g},s=function(h,p){var g=null;return m(h)=="array"?g=u(h,p):m(h)=="object"&&(g=r(h,p)),g},f={create:function(h,p){if(n(h)){let g=new Set(h);m(p)=="array"?p.forEach(b=>{g.add(b)}):g.add(p),h=Array.from(g)}else i(h)&&(i(p)?a(p,function(g,b){h[b]=g}):h[p]=p);return h},createOrUpdate:function(h,p){var g=s(h,p);return m(h)=="array"?e(g)?h.includes(p):h[g]=p:m(h)=="object"&&(e(g)?i(p)?a(p,function(b,v){c(h,b,v)}):h[p]=p:h[g]=p),h},remove:function(h,p){if(m(p)=="string"){var g=s(h,p);if(m(h)=="object")delete h[g];else if(m(h)=="array"){for(var b=[],v=0;v<h.length;v++)if(v!=g)b.push(h[v]);else continue;h=b}return h}else{if(m(p)=="object")return Object.filter(h,function(w,_){var O=p[_]!=null&&p[_]==w;return!O});if(m(p)=="array")return Object.filter(h,function(w,_){var O=p.contains(_);return!O})}if(e(g))return!1},get:function(h,p){var g=m(p);if(g=="string"){var b=s(h,p);if(b==0||b)return h[b]}else{if(g=="object")return Object.filter(h,function(v,w){var _=!t(p[w])&&p[w]==v;return _});if(g=="array")return Object.filter(h,function(v,w){var _=p.contains(w);return _})}return null},getNot:function(h,p){var g=m(p);return g=="string"?Object.filter(h,function(b,v){var w=v!=p;return w}):g=="object"?Object.filter(h,function(b,v){return Object.some(p,function(w,_){var O=_==v&&w==b;return!O})}):g=="array"?Object.filter(h,function(b,v){var w=!p.contains(v);return w}):null},getAll:function(h){return h}},y=class{constructor(h,p,g){this.type=h,this.name=p,this.child=g,this.cache={},m(this.child)=="string"&&(this.child=g=="array"?[]:g=="object"?{}:!1)}init(h){return this[this.type]?(this[this.type](h),!0):!1}open(){if(this.type=="session"){var h=JSON.parse(sessionStorage[this.name]);return h[this.name]}else if(this.type=="local"){var h=JSON.parse(localStorage[this.name]);return h[this.name]}else return this.cache[this.name]}close(h){return this.child=h,this.create(),this.init(!0)}create(){this.cache[this.name]=this.child}array(){this.create()}object(){this.create()}session(h){this.create();try{sessionStorage[this.name]?h&&sessionStorage.setItem(this.name,JSON.stringify(this.cache)):sessionStorage.setItem(this.name,JSON.stringify(this.cache))}catch{this.create()}}local(){this.create();try{localStorage.setItem(this.name,JSON.stringify(this.cache))}catch{this.create()}}},d=class{constructor(h){if(this.name=h.name,this.storageType=h.storage,this.child=h.child||"object",m(this.child)=="string"&&(this.child=this.child=="array"?[]:this.child=="object"?{}:null),!["array","object"].includes(m(this.child)))throw new Error("the child must be an object or array type.");this.storage=new y(this.storageType,this.name,this.child),this.storage.init()}has(h){var p=this.storage.open(),g=s(p,h);return e(g)?!1:g}get(h){var p=this.storage.open();return Promise.resolve(f.get(p,h))}getNot(h){var p=this.storage.open();return f.getNot(p,h)}getAll(){var h=this.storage.open();return Promise.resolve(h)}update(h,p){var g=this.storage.open(),b=s(g,h);return b==0||b?(g=f.createOrUpdate(g,data),this.storage.close(g)):!1}createOrUpdate(h){if(arguments.length>1){let g=arguments[0],b=arguments[1];h={[g]:b}}var p=this.storage.open();return p=f.createOrUpdate(p,h),this.storage.close(p)}create(h){var p=this.storage.open();return p=f.create(p,h),this.storage.close(p)}remove(h){var p=this.storage.open();return p=f.remove(p,h),this.storage.close(p)}};T.StorageKit=d})(window)});var F=P(()=>{(function(T){function m(a){this.el=m.toArray(a)}m.toArray=function(a){let c=[];switch(!0){case a instanceof Array:c=a;break;case(a.length&&a.tagName&&a.tagName!="FORM"&&!(a instanceof Array)):for(let e=0;e<a.length;e++)c.push(a[e]);break;case!(a instanceof Array):c=[a];break}return c},m.prototype.getElements=function(){return this.el},m.prototype.getElement=function(){return this.el[0]},m.prototype.remove=function(a){let c=-1,e=this.el.length,t=document.createDocumentFragment();for(;++c<e;){let n=this.el[c];n&&t.appendChild(n)}fr=null},m.prototype.replaceDataSrc=function(){let c=this.el[0].querySelectorAll("[data-src]");for(let e=0;e<c.length;e++)el=c[e],el.setAttribute("src",el.dataset.src),el.removeAttribute("data-src")},m.cloneNode=function(a){a=a instanceof Array?a:this.toArray(a);let c=[];for(let e=0;e<a.length;e++)c.push(a[e].cloneNode(!0));return new m(c)},m.prototype.dataset=function(a,c){let e=this.el.length,t=-1;for(;++t<e&&!(this.el[t].dataset[a]&&c(this.el[t])=="break"););return!0},m.prototype.getContainers=function(){return this.getElementsByDataset("container").container},m.prototype.cloneNode=function(a){return a=this.el,m.cloneNode(a)},m.prototype.getAllElements=function(){let a=this.el.length,c=[];switch(!0){case a==1:c=this.el[0].getElementsByTagName("*").toArray();break;case a>1:{let e=-1;for(;++e<a;){let n=this.el[e].getElementsByTagName("*");if(n)for(let i=0;i<n.length;i++)c.push(n[i])}}break}return c},m.prototype.appendTo=function(a,c){if(!a&&!a.attributes)throw new TypeError(`the ${a} is not an instance of Element`);c&&(a.innerHTML="");for(let e=0;e<this.el.length;e++){let t=this.el[e];a.appendChild(t)}},m.prototype.getElementsByTagName=function(a){let c=this.el.length,e=[];switch(!0){case c==1:e=this.el[0].getElementsByTagName(id).toArray();break;case c>1:{let t=-1;for(;++t<c;){let i=this.el[t].getElementsByTagName(selector);if(i)for(let u=0;u<i.length;u++)e.push(i[u])}}break}return e},m.prototype.getElementById=function(a){let c=this.el.length,e=[];switch(!0){case c==1:e=this.el[0].getElementById(id);break;case c>1:{let t=-1;for(;++t<c;){let i=this.el[t].querySelector(selector);i&&e.push(i)}}break}return e},m.prototype.querySelectorAll=function(a){let c=this.el.length,e=[];switch(!0){case c==1:e=this.el[0].querySelectorAll(a);break;case c>1:{let t=[],n=-1;for(;++n<c;){let u=this.el[n].querySelectorAll(a);u&&(e=e.concat(u.toArra()))}}break;default:e=[]}return e},m.prototype.querySelector=function(a){let c=this.el.length,e=[];switch(!0){case c==1:e=this.el[0].querySelector(a);break;case c>1:{let t=-1;for(;++t<c;){let i=this.el[t].querySelector(a);i&&e.push(i)}}break}return e},m.prototype.querySelectorIncluded=function(a,c,e){let t=this.el.length,n=[];switch(!0){case t==1:n=this.el[0].querySelectorIncluded(a,c,e);break;case t>1:{let i=-1;for(;++i<t;){let r=this.el[i].querySelectorIncluded(a,c,e);r&&n.push(r)}}break}return n},m.prototype.querySelectorAllIncluded=function(a,c,e){let t=this.el.length,n=[];switch(!0){case t==1:n=this.el[0].querySelectorAllIncluded(a,c,e);break;case t>1:{let i=-1;for(;++i<t;){let r=this.el[i].querySelectorAllIncluded(a,c,e);r&&(n=n.concat(r.toArra()))}}break}return n},m.prototype.contains=function(a){let c=this.el.length,e=!1;switch(c==1){case!0:e=this.el[0].contains(a);break;case!1:{let t=-1;for(;++t<c;)if(this.el[t].contains(a)){e=!0;break}}break}return e},m.prototype.getElementsByDataset=function(){let a,c,e,t,n,i;for(a=arguments,o={},length=a.length,e=-1,t=-1;++e<this.el.length;)for(n=this.el[e];++t<length;)c=a[t],n.getAttribute(`data-${c}`)?o[c]=[n]:o[c]=[],i=n.querySelectorAll(`[data-${c}]`),i.length&&(o[c]=o[c].concat([...i]));return o},T.Piece=m})(window)});var x=P(()=>{(function(T){function m(a,c,e){this.subscribe=a,this.handlers=c,this.logger=e||!1,this.stat={handlers:{},subscribe:{}},this.results={},this.wm=new WeakMap}m.prototype.notify=function(a,c,e,t,n,i){function u(){return{_component:a,_event:c,_e:e}}function r(p){return p}let{_component:s,_event:f,_e:y}=u(),d=this.handlers[s]&&this.handlers[s][f];if(d==null&&n){let p={[f]:function(){return y}};p[f].binded=s,p[f].listenTo=i,d=p[f]}if(s=d.binded,d=d,!d){console.error(`no setup handler for the event ${f} in ${s} component`);return}let h=new Promise((p,g)=>{let b=d(y);p(b)});return this.stat.handlers[d.original]+=1,h.then(p=>{let g=[];if(this.results[s]||(this.results[s]={}),this.subscribe[s]&&this.subscribe[s][f]){let b=this.subscribe[s][f];t=t?(()=>{b=b.filter(v=>{let w=v.binded;return t.includes(w)})})():!0;for(let v=0;v<b.length;v++){let w=b[v];this.stat.subscribe[w.original]+=1,g.push(new Promise((_,O)=>{try{let S=(()=>w(p))();S&&S.ObjectType=="Promise"?S.then(k=>{this.results[s]||(this.results[s]={}),this.results[s][f]=S,_()}).catch(k=>{O(k)}):(this.results[s][f]=S,_())}catch(S){console.log(S),O(S)}}))}}else this.logger&&console.info(`no subscriber for (${f}) event of (${s}) component`),this.results[s][f]=p;return Promise.all(g).then(()=>{p=null})})},m.prototype.registerSubscribe=function(a){return new Promise((c,e)=>{for(component in a)if(a.hasOwnProperty(component))if(!this.subscribe[component])this.subscribe[component]={};else continue;c()}).then(()=>{let c={};for(component in a)if(a.hasOwnProperty(component)){let e=a[component];for(let t in e)if(e.hasOwnProperty(t)){let n=e[t];for(let i=0;i<n.length;i++){let u=n[i];c[component]||(c[component]={}),c[component][u.original]||(c[component][u.original]=[]),c[component][u.original].push(u),this.stat.subscribe[u.original]=0}}}return c}).then(c=>{for(let e in c)if(c.hasOwnProperty(e)){this.subscribe[e]||(this.subscribe[e]={});for(let t in c[e])if(c[e].hasOwnProperty(t))for(let n of c[e][t])this.subscribe[e][n.original]||(this.subscribe[e][n.original]=[]),this.subscribe[e][n.original].push(n)}c={}})},m.prototype.registerHandlers=function(a,c){this.handlers[c]||(this.handlers[c]={});for(let e in a)if(a.hasOwnProperty(e)){let t=a[e];this.handlers[c][e]=t,this.stat.handlers[t.original]=0}},T.Observer=m})(window)});var D=P(()=>{(function(T){function m(a,c,e){this.data=a,this.template=c,this.isConvert=e}m.prototype._getTag=function(a){return a.match(new RegExp("(?<=<)|([^/s]+)(?=>)","g"))[2]},m.prototype._bindReplace=function(a,c){for(let e in a)if(a.hasOwnProperty(e)){let t=new RegExp(`{{${e}}}`,"g");t&&(c=c.replace(t,`${a[e]}`))}return c},m.prototype._toElement=function(a,c){let e=document.createElement("template");return e.innerHTML=a,e.content.children[0]},m.prototype.createElement=function(){let a=this.template,c=this.data,e=this.isConvert;if(c){if(c instanceof Array){let t=typeof a=="string",n=t?this._getTag(a):a.tagName;a=t?a:a.outerHTML;let i=[];for(let u=0;u<c.length;u++){let r=c[u],s=this._bindReplace(r,a),f=this._toElement(s,n);e&&(f=f.outerHTML),i.push(f)}return i}else if(c instanceof Object){let t=typeof a=="string",n=t?this._getTag(a):a.tagName;a=t?a:a.outerHTML;let i=this._bindReplace(c,a),u=this._toElement(i,n);return e&&(u=u.outerHTML),u}}else{let n=typeof a=="string"?this._getTag(a):a.tagName;return this._toElement(a,n)}},T.Templating=m})(window)});var W=P(()=>{});var J=P(()=>{(function(T){function m(a,c){this.pKey=c.pKey||"$scope",this.temp={},this.trap=c.trap,this.notify=[],this.parent=a,this._clone={},this.whitelist=["extend","set","get"],this.install()}m.prototype.registerNotifier=function(a){this.notify.push(a)},m.prototype.notifier=function(a){Cake.$scope[a.bind]=a.value},m.prototype.method=function(){let a=this.temp,c=this.trap,e=this.notify,t=this.parent,n=this.whitelist;return{update(i,u){if(!!i.length)for(let r=0;r<i.length;r++){let s=i[r];u(s)}},defineProperty(i,u){Object.defineProperty(a,i,{configurable:!0,get(){let r=c.bind(t)(i)||!1;return r||u[i]},set(r){if(!n.includes(i)){let s=this[i];for(let f=0;f<e.length;f++)e[f](i,r,s);u[i]=r}}})}}},m.prototype.install=function(){let{update:a,defineProperty:c}=this.method(),e=this.temp,t=this._clone;Object.defineProperty(this.parent,this.pKey,{configurable:!0,get(){t=Object.assign(t,e);let n=Object.keys(e);return a(n,function(i){c(i,t)}),e}})},m.prototype.watch=function(a){if(!a)return;let{update:c,defineProperty:e}=this.method(),t=this._clone;return c(a,function(n){e(n,t)}),!0},m.prototype.set=function(a,c){if(this.whitelist.includes(a))return;let e=this._clone,t=this.notify||[],n=e[a];return e[a]=c,Promise.all(t.map(i=>i(a,c,n)))},T.Scope=m})(window)});var K=P(()=>{});var G=P(()=>{});var Y=P((Be,X)=>{X.exports=function(){let T=this;this.$form={},this.$form.options=(m,a)=>{let{options:c,params:e}=m;return c||(c=[]),Promise.all(c.map(n=>{let{control:i,field:u,tbl:r,src:s,schema:f}=n;return T.fire(s,{tbl:r,field:u,params:e}).then(y=>{y=y||[],n.query=y,y=y.map(h=>f(h));let d=f({});for(let h in d)d.hasOwnProperty(h)&&(d[h]="");return y.unshift(d),n.options=y,n})})).then(n=>a?n.reduce((i,u)=>{let{type:r,control:s}=u;return r||(r="select"),i[r]||(i[r]={}),i[r][s]||(i[r][s]=u),i},{}):n.reduce((i,u)=>(i[u.control]=u.options,i),{})).catch(n=>{console.error(n)})},this.$form.plot=m=>{let{data:a,container:c}=m;if(!a&&!c)return;let e=(t,n,i)=>{if(!t){console.info("root is not provided!");return}let u=t.querySelectorAll(`${n}`),r=u.length;if(!r){i(null,a);return}for(let s=0;s<r;s++){let f=u[s],y=f.name,d=a[y],h=i(f,d,s);if(h=="break")break;h!="continue"}};return e(c,"INPUT.input",function(t,n){n!=null&&(t.type=="date"&&(n=new Date(n)=="Invalid Date"?"":new Date(n).toJSON().split("T")[0]),t.value=n)}),setTimeout(()=>{e(c,"SELECT.input:not(.cake-template)",function(t,n){e(t,"OPTION:not(.cake-template)",function(i,u,r){if(i){if(i.value==n)return t.selectedIndex=r,"break"}else console.log(i,u,"provide schema")})})},500),Promise.resolve()}}});var Q=P((Fe,z)=>{z.exports=function(T){let{StorageKit:m,Templating:a}=T;function c(){this.uiid=0,this.notify=[],this.st={},this.cacheStatic=[],this.store=m({child:"object",storage:"session",name:"_cake_component_cf"})}return c.prototype._getConfig=function(e,t,n,i,u){if(n==null)return[];if(n==i&&e!="bind")return[];let r=`${e}-${t}-${u}`,s=Object.cache._getConfig;if(s||(s=Object.cache._getConfig={}),!s[r]){var f=u?this.st[u]&&this.st[u][e]||[]:(()=>{let y=[];for(let d in this.st)if(this.st.hasOwnProperty(d)){let h=this.st[d];if(h[e])for(let p=0;p<h[e].length;p++){let g=h[e][p];g.bind==t&&y.push({...g,component:d})}}return y})();s[r]=f}return s[r]},c.prototype._notifyToggle=function(e,t,n,i,u){u=u||document;let r=this._getConfig("toggle",e,t,n);if(!!r){u=u||document;for(let s=0;s<r.length;s++){let f=r[s];if(!f)continue;let{sel:y,bind:d,value:h,ops:p}=f,g=u.querySelector(`[data-toggle=${y}]`);h==n&&g&&g.classList.remove("is-active"),h==t&&g&&(g.classList.contains("is-active")&&g.classList.remove("is-active"),g&&g.classList.add("is-active"))}}},c.prototype._notifySwitch=function(e,t,n,i,u){u=u||document;let r=this._getConfig("switch",e,t,n,i);if(!r.length)return;let s={};for(let f=0;f<r.length;f++){let y=r[f],{bind:d,sel:h,map:p,cases:g}=y,b=u.querySelectorAll(`[data-switch-slot=${h}]`);for(let v=0;v<t.length;v++){let w=t[v],_=b[v],O=w[p];if(O!=null){let S=null;for(let k=0;k<g.length;k++)if(g[k].bind.includes(O)){S=g[k];break}if(S){let{_id:k,bind:C}=S,A=document.querySelector(`[data-case=${h}-${k}]`);if(A&&A.toString().includes("Element")){A=A.cloneNode(!0);let L=A.querySelectorAll("[data-for-auto=true]");for(let E=0;E<L.length;E++){let q=L[E];q.dataset.for=`${q.dataset.for}-active`}A.removeAttribute("data-case");let $=new a(w,A,!1).createElement();if(A.dataset.if){let E=A.dataset.if,q=$.dataset.ifBind,I=y.component,{bind:j}=this.getWatchItemsBySel(I,"if",E);E&&(s[j]||(s[j]={}),s[j][q]=w)}$.classList.remove("cake-template"),_.replaceWith($)}}}}}for(let f in s)s.hasOwnProperty(f)&&this._notifyIf(f,s[f])},c.prototype._notifyBind=function(e,t,n,i,u){u=u||document;let r=this._getConfig("bind",e,t,n,i);if(!!r.length)for(let s=0;s<r.length;s++){let f=r[s],{attr:y,bind:d,sel:h}=f,p=y.toHyphen();if(e==d){let g=u.querySelectorAll(`[data-bind=${h}]`);for(let b=0;b<g.length;b++){let v=g[b];y=="className"?n?t?v.classList.replace(n,t):v.classList.remove(n):v.classList.add(t):(v.setAttribute(p,t),v[y]=t)}}}},c.prototype._notifyFor=function(e,t,n,i,u){let r=this._getConfig("for",e,t,n,i);if(!r.length)return;let s=[];for(let f=0;f<r.length;f++){let{bind:y,sel:d,iter:h,ins:p,component:g}=r[f];u=u||document,g&&(u=Cake.Components[g].html);let b=u.querySelectorIncluded(`[data-for-template=${d}]`),v=b.cloneNode(!0);(()=>{let w=v&&v.querySelectorAll("[data-switch]");if(w&&w.length){let _=w.length,O=-1;for(;++O<_;){let S=w[O],k=S.parentElement,C=document.createElement("div");C.dataset.switchSlot=S.dataset.switch,k.replaceChild(C,S)}w=null}})(),(()=>{let w=v,_=-1;l=t.length,t=t.map(O=>{for(let S in O)O.hasOwnProperty(S)&&(O[`${h}.${S}`]=O[S]);return O}),t.forEach(O=>{let S=new a(O,w,!1).createElement();S.style.removeProperty("display"),S.classList.remove("cake-template"),S.removeAttribute("data-for-template"),b.insertAdjacentElement("beforebegin",S);let k=S.querySelectorAll("[data-src]");if(k)for(let C=0;C<k.length;C++){let A=k[C];A.src=A.dataset.src,A.removeAttribute("data-src")}})})()}this._notifyForAuto({configs:r,newValue:t})},c.prototype._notifyForAuto=function(e){let{vItems:t,configs:n,newValue:i}=e;for(let u=0;u<n.length;u++){let r=n[u],s=r.children;if(!s)continue;let f=[];for(let y=0;y<s.length;y++){let d=s[y];if(!this.st[r.component])continue;let h=this.st[r.component].for.find(p=>p.sel==d);h&&f.push(new Promise(p=>{let{bind:g,sel:b,iter:v,ins:w}=h;setTimeout(()=>{let _=document.querySelectorAll(`[data-for=${b}-active]`);for(let O=0;O<_.length;O++){let S=_[O],k=S.dataset.forBindKey,C=S.dataset.forBindVal,A=i.find(E=>E[k]==C),L=g.split(".")[g.split(".").length-1],$=A[L].length&&A[L].map(E=>E instanceof Object?E:{[v]:E});if($)for(let E=0;E<$.length;E++){let q=$[E],I=S.cloneNode(!0),j=new a(q,I,!1).createElement();j.style.removeProperty("display"),j.classList.remove("cake-template"),j.removeAttribute("data-for-template"),S.insertAdjacentElement("beforebegin",j)}S.parentElement.tagName=="SELECT"&&(S.parentElement.selectedIndex=0)}})}))}}},c.prototype._notifyForUpdate=function(e,t,n,i,u){u=u||document;let r=this._getConfig("forUpdate",e,t,n,i);if(!!r.length)for(let s=0;s<r.length;s++){let{bind:f,sel:y,iter:d,ins:h}=r[s];for(let p in t)if(t.hasOwnProperty(p)){let g=document.querySelectorAll(`[data-for-bind-val=${p}]`);for(let b=0;b<g.length;b++){let v=g[b],w=v.dataset.forBindVal;if(!v.dataset.forTemplate)v.remove();else{let _=v.cloneNode(!0);_.style.removeProperty("display"),_.classList.remove("cake-template");let O=t[w],S=-1;for(l=O.length;++S<l;){let k=O[S],C=new a(k,_,!1).createElement();C.classList.remove("cake-template"),C.removeAttribute("data-for-template"),v.insertAdjacentElement("beforebegin",C),v.parentElement.tagName=="SELECT"&&(v.parentElement.selectedIndex=0)}}}}}},c.prototype._notifyClass=function(e,t,n,i,u){u=u||document;let r=this._getConfig("class",e,t,n,i);if(!r.length)return;let s=function(d,h,p){switch(!0){case h==">":return d>p;case h=="<":return d<p;case h=="===":return d===p;case h=="!==":return d!==p;case h=="==":return d==p;case h=="!=":return d!=p}return!1},f=function(d){return d.split(" ").join("")},y={};for(let d=0;d<r.length;d++){let h=r[d],{hasNegate:p,bind:g,testVal:b,className:v,ops:w,sel:_}=h;if(g=f(g),v=f(v),e==g){y[_]||(y[_]=u.querySelectorAll(`[data-class=${_}]:not(.cake-template)`));let O=y[_];for(let S=0;S<O.length;S++){let k=O[S],C=!1;w?(C=s(t,w,b),p&&(C=!C)):p&&(C=!t),C?k.classList.contains(v)||k.classList.add(v):k.classList.contains(v)&&k.classList.remove(v)}}}},c.prototype._notifyIf=function(e,t,n,i,u){u=u||document;let r=this._getConfig("if",e,t,n,i);if(!r.length)return;let s={};for(let f=0;f<r.length;f++){let y=r[f],{attr:d,bind:h,sel:p,testval:g,_true:b,_false:v}=y,w=d.toHyphen();if(e==h){s[p]||(s[p]=u.querySelectorAll(`[data-if=${p}]:not(.cake-template)`));let _=s[p];for(let O=0;O<_.length;O++){let S=_[O],k=S.dataset.ifBind,C=k?t[k]:t,A=C instanceof Object?C[h]:C,L=g==null?!!A:g==A;A==null?S.removeAttribute(w,A):L?b=="null"||(S.setAttribute(w,A),S[d]=A):v=="null"||(S.setAttribute(w,A),S[d]=A)}}}},c.prototype.notifier=function(e,t,n){let i=JSON.parse(JSON.stringify(t));return new Promise(u=>{this._notifyFor(e,i,n),u()}).then(()=>this._notifyForUpdate(e,i,n)).then(()=>this._notifySwitch(e,i,n)).then(()=>this._notifyToggle(e,i,n)).then(()=>this._notifyBind(e,i,n)).then(()=>this._notifyIf(e,i,n)).then(()=>this._notifyClass(e,i,n))},c.prototype.registerNotifier=function(e){this.notify.push(e)},c.prototype.getEventTarget=function(e){let t=`${e}`,n=Object.cache.getEventTarget;if(n||(n=Object.cache.getEventTarget={}),!n[t]){let i=this.st[e];n[t]=i&&(i?.evt??[])||[]}return n[t]},c.prototype.getWatchItems=function(e){let t=`${e}`,n=Object.cache.getWatchItems;if(n||(n=Object.cache.getWatchItems={}),!n[t]){let i=this.st[e]||{},u=new Set;for(let r in i)if(i.hasOwnProperty(r)){let s=i[r];for(let f=0;f<s.length;f++){let y=s[f],{bind:d}=y;if(d)u.add(d);else continue}}n[t]=[...u]}return n[t]},c.prototype.getWatchItemsByType=function(e,t){let n=`${e}-${t}`,i=Object.cache.getWatchItemsByType;if(i||(i=Object.cache.getWatchItemsByType={}),!i[n]){let r=(this.st[e]||{})[t]||[],s=new Set;for(let f=0;f<r.length;f++){let y=r[f],{bind:d}=y;switch(!!d){case!0:s.add(d);break;default:switch(!0){case(t=="animate"||t=="toggle"):(s.constructor.name="Set")&&(s=[]),s.push(y)}}}i[n]=[...s]}return i[n]},c.prototype.getWatchItemsBySel=function(e,t,n){let i=`${e}-${t}-${n}`,u=Object.cache.watchItemsBySel;if(u||(u=Object.cache.watchItemsBySel={}),!u[i]){let s=this.st[e][t].find(f=>f.sel==n);u[i]=s||!1}return u[i]},c.prototype._register=function(e,t,n,i){switch(!0){case!e[t]:e[t]={};case!e[t][n]:e[t][n]=[];default:e[t][n].push(i);break}},c.prototype._static=function(e){return function(t,n){let i=[];for(let u=0;u<t.length;u++){let r=t[u];switch(n){case!1:i.push(r);break;case!0:{let s=r.closest("[data-component]");switch(s=s&&s.dataset.component,s==e){case!0:i.push(r);break}}break;default:continue}}return i}},c.prototype._compileEvents=function(e,t,n){return new Promise(i=>{if(!e.length){i();return}let u=this._static(t)(e,n);if(!u.length){i();return}for(let r=0;r<u.length;r++){let s=`cke${this.uiid}`,f=u[r],y=f.dataset.event.split(" ").join("").split(",");for(let d=0;d<y.length;d++){let[h,p]=y[d].split(":");p=p||h,this._register(this.st,t,"evt",{event:h,sel:s,cb:p}),f.dataset.event=s,this.uiid++}}i()})},c.prototype._compileToggle=function(e,t,n){return new Promise(i=>{if(!e.length){i();return}if(!this._static(t)(e,n).length){i();return}let r={};for(let s=0;s<e.length;s++){let f=`ckt${this.uiid}`,y=e[s],d=y.dataset.toggle;r[d]&&(f=r[d]),this._register(this.st,t,"toggle",{sel:f,name:"ns-"+d}),y.dataset.toggle=f,this.uiid++,r[d]=f}r={},i()})},c.prototype._compileFor=function(e,t,n,i){return new Promise(u=>{let r=i;if(!e.length){u();return}let s=this._static(t)(e,n);if(!s.length){u();return}let f={};for(let y=0;y<s.length;y++){let d=`ckf${this.uiid}`,h=s[y],p=h.dataset.for,[g,b,v]=p.split(" ");if(h.style.display="none",h.classList.add("cake-template"),h.dataset.for=d,h.dataset.forTemplate=d,f[d]={bind:v,sel:d,iter:g,ins:b},++this.uiid,y!=0){let w=h.parentElement&&h.parentElement.closest("[data-for]");if(!w)continue;let _=!!w.dataset.for;if(r.contains(w)&&_){let O=w.dataset.for,S=f[O];S&&!S.children?S.children=[d]:S&&S.children.push(d)}}}for(let y in f)f.hasOwnProperty(y)&&this._register(this.st,t,"for",f[y]);u()})},c.prototype._compileForUpdate=function(e,t,n){return new Promise(i=>{if(!e.length){i();return}let u=this._static(t)(e,n);if(!u.length){i();return}for(let r=0;r<u.length;r++){let s=`ckfu${this.uiid}`,f=u[r],y=f.dataset.forUpdate;f.style.display="none",f.classList.add("cake-template"),f.dataset.forUpdate=s,f.dataset.for||(f.dataset.forTemplate=s);let[d,h,p]=y.split(" ");this._register(this.st,t,"forUpdate",{bind:p,sel:s,iter:d,ins:h}),this.uiid++}i()})},c.prototype._compileSwitch=function(e,t,n){return new Promise(i=>{if(!e.length){i();return}let u=this._static(t)(e,n);if(!u.length){i();return}for(let f=0;f<u.length;f++){let y=`cks${this.uiid}`,d=u[f],h=d.dataset.switch,p="def";if(h.includes(".")){var[r,...s]=d.dataset.switch.split(".");h=r,p=s[0]}d.dataset.switch=y;let g=d.querySelectorAll("[data-case]"),b=[];for(let v=0;v<g.length;v++){let w=g[v],_=w.closest(`[data-switch=${y}]`);if(w.classList.add("cake-template"),_){let O=w.dataset.case,S=`cksc${this.uiid}`;w.dataset.case=`${y}-${S}`,b.push({_id:S,bind:O}),this.uiid++}}this._register(this.st,t,"switch",{bind:h,sel:y,map:p,cases:b}),this.uiid++}i()})},c.prototype._compileBind=function(e,t,n){return new Promise(i=>{if(!e.length){i();return}let u=this._static(t)(e,n);if(!u.length){i();return}for(let f=0;f<u.length;f++){let y=`ckm${this.uiid}`,d=u[f],p=d.dataset.bind.split(",");for(let g=0;g<p.length;g++){let b=p[g].split(" ").join("");if(b.includes(":"))var[r,s]=b.split(":");else var s=b,r="value";this._register(this.st,t,"bind",{attr:r,bind:s,sel:y})}this.uiid++,d.dataset.bind=y}i()})},c.prototype._compileAnimate=function(e,t,n){return new Promise(i=>{if(!e.length){i();return}let u=this._static(t)(e,n);if(!u.length){i();return}for(let r=0;r<u.length;r++){let s=`cka${this.uiid}`,f=u[r],y=f.dataset.animate;y=y.split(" ").join("");let d={},h=y.split(",");for(let p=0;p<h.length;p++){let g=h[p],[b,v]=g.split(":");if(b=="ns"){d.ns=v;break}else d[b]={keyframes:v.split("-")}}d.selector={attr:"data-animate",val:s},this._register(this.st,t,"animate",d),this.uiid++,f.dataset.animate=s}i()})},c.prototype._compileIf=function(e,t,n){return new Promise(i=>{if(!e.length){i();return}let u=this._static(t)(e,n);if(!u.length){i();return}for(let r=0;r<u.length;r++){let s=`ci${this.uiid}`,f=u[r],d=f.dataset.if.split(",");for(let h=0;h<d.length;h++){let p=d[h].split(" ").join(""),[g,b]=p.split("=");b=b.split(new RegExp("[()]")).join("");let[v,w]=b.split("?"),[_,O]=v.split(new RegExp("<|>|===|==|!==|!=")),[S,k]=w.split(":");this._register(this.st,t,"if",{attr:g,bind:_,testval:O||null,_true:S,_false:k,sel:s})}this.uiid++,f.dataset.if=s}i()})},c.prototype._compileClass=function(e,t,n){return new Promise(i=>{if(!e.length){i();return}let u=this._static(t)(e,n);if(!u.length){i();return}for(let r=0;r<u.length;r++){let s=`cc${this.uiid}`,f=u[r],y=f.dataset.class,[d,h]=y.split("&&");d=d.trim();let[p,g,b]=d.split(" "),v=p.substring(0,1);v&&(p=p.slice(1)),this._register(this.st,t,"class",{hasNegate:v,bind:p,testVal:b,className:h,ops:g,sel:s}),this.uiid++,f.dataset.class=s}i()})},c.prototype.inject=function(e,t,n=!1){return new Promise(i=>{let u=e.getElementsByDataset("bind","for","for-update","switch","toggle","event","animate","if","class");i(u)}).then(i=>{let u=[],r={bind:this._compileBind,for:this._compileFor,"for-update":this._compileForUpdate,switch:this._compileSwitch,toggle:this._compileToggle,event:this._compileEvents,animate:this._compileAnimate,if:this._compileIf,class:this._compileClass};for(let s in i)i.hasOwnProperty(s)&&i[s].length&&u.push(r[s].apply(this,[i[s],t,n,e]));return console.timeEnd(t),u.length?Promise.all(u):Promise.resolve()}).then(()=>this.store.createOrUpdate(t,this.st[t]))},c}});var V=P((xe,Z)=>{Z.exports=function(T){let{Mo:m,Templating:a,Piece:c}=T;function e(t,n,i){this.name=t,this.template=n,this.handlers=i.handlers,this.subscribe=i.subscribe,this.data={},this.root=i.root,this.items=!1,this.type=i.type||"view",this.toggle=i.toggle,this.targets={},this.animateOptions=i.animate,this.role=i.role,this.isReady=!1,this.await={},this.utils={createFn(u,r){return{[u]:function(){return r}}[u]}},i.data&&i.data.bind(this.data)(this),(t=="app"||i.role=="app")&&(this.staticComponent=i.static||[]),i.trigger&&i.trigger.bind(this)(),i.utils&&i.utils.bind(this.utils)(this),this.container={},this.compile=new Promise(u=>{this._bindHandlers(),u()}).then(()=>{this._bindSubscribe()}).then(()=>{switch(this.type=="view"&&!!this.template){case!0:this.createElementAsync();break;default:this.isStatic=!1;break}})}return e.prototype.isStatic=!1,e.prototype.hasEvent=!1,e.prototype.isConnected=!1,e.prototype.destroyed=!1,e.prototype.isCreated=!1,e.prototype.Subscribe=function(t){this.$observer.registerSubscribe({[t.listenTo]:{[t.original]:[t]}})},e.prototype.Node=function(t){return new c(t)},e.prototype._bindHandlers=function(){for(let t in this.handlers)if(this.handlers.hasOwnProperty(t)){let n=this.handlers[t],i=n.name;n=n.bind(this),n.original=i,n.binded=this.name,this.handlers[i]=n,this.initAwaitHandlers(t)}this.await.destroy||(this.await.destroy=Promise.resolve()),this.await.animateRemove||(this.await.animateRemove=Promise.resolve())},e.prototype.initAwaitHandlers=function(t){this.await[t]=Promise.resolve()},e.prototype._bindSubscribe=function(){let t={};for(let n in this.subscribe)if(this.subscribe.hasOwnProperty(n))if(subscribe=this.subscribe[n],!!subscribe.components&&!!subscribe.handler){let u=n,{components:r,handler:s}=subscribe;s=s.bind(this),s.binded=this.name,s.original=u;for(let f=0;f<r.length;f++){let y=r[f];t[y]||(t[y]={}),t[y][u]||(t[y][u]=[]),s.listenTo=y,t[y][u].push(s)}}else{t[n]||(t[n]={});let u=subscribe;for(let r in u)if(u.hasOwnProperty(r)){let s=u[r],f=s.name;s=s.bind(this),s.original=f,s.binded=this.name,s.listenTo=n,t[n][f]||(t[n][f]=[]),t[n][f].push(s)}}this.subscribe=t},e.prototype.notifyStaticComponent=function(t,n,i){Cake.Observer.notify(t,n,i,this.staticComponent[t],!0,this.name)},e.prototype.doFor=function(t,n){let i=()=>this.html;n!=null&&this.$attrib._notifyFor(t,n,null,this.name,i())},e.prototype.doToggle=function(t,n){this.$attrib._notifyToggle(t,n,null,this.name,this.html)},e.prototype.doSwitch=function(t,n){this.$attrib._notifySwitch(t,n,null,this.name,this.html)},e.prototype.doIf=function(t,n){this.$attrib._notifyIf(t,n,null,this.name,this.html)},e.prototype.$animate=function(t){let n=this.$attrib.getWatchItemsByType(this.name,"animate"),i=this.animateOptions,u=[];return(()=>{if(!(!n.length&&!(n instanceof Array)||!i))for(let r=0;r<n.length;r++){let s=n[r],{ns:f,selector:y}=s;if(s.ns){if(i[f]){let d=i[f];Object.assign(s,i[f]),delete i[f]}}else u.push(n)}})(),n.length?((()=>{let r={},s={};for(let f in i)i.hasOwnProperty(f)&&(s.val=f,r.selector=s,Object.assign(r,i[f]),n.push(r),r={},s={})})(),new m(n,this.html).animate(t)):!1},e.prototype.$templating=function(t,n,i){let u=n||this.template;return new a(t,u,i).createElement()},e.prototype.createElement=function(){if(!(this.template.substring(0,1)=="#"))return;let n=this.template.substr(1),i=document.getElementById(n);switch(this.isTemplate=i&&i.toString().includes("Template")){case!0:{let r=i.getContent(!0);r.cake_component=this.name,this.html=this.Node(r),this._parseHTML(this.isStatic).then(()=>{this._watchBindedItems()})}break;case null:break;default:{let r=i;r.cake_component=this.name,this.html=this.Node(r),this.isStatic=!0,this._parseHTML(this.isStatic).then(()=>{})}}},e.prototype.createElementAsync=function(){new Promise(t=>{this.createElement(),t()}).then(()=>{this.isReady=!0})},e.prototype._isParsed=!1,e.prototype._parseHTML=function(t=!1){return this.$attrib.inject(this.html,this.name,t).then(()=>{this.original=this.html.cloneNode(),this._isParsed=!0})},e.prototype.render=function(t){let n=null,i=p=>this.data[p]||this.$scope[p]||null;!this.isReady&&this.createElement();let{root:u,multiple:r,cleaned:s,emit:f,static:y,hashed:d,data:h}=t||{};return d===!0&&this.$hash.add(this.name),!this.template&&this.fire.isConnected&&this.fire.isConnected({emit:f},!0),!!u&&(this.root=u),r&&this._smoothReset(),new Promise((p,g)=>{this.await.destroy.then(()=>this.await.animateRemove).then(()=>{new Promise((b,v)=>{b()}).then(()=>{let b=this.$attrib.getWatchItemsByType(this.name,"for");for(let v=0;v<b.length;v++){let w=i(b[v]);this.doFor(b[v],w)}return this.html}).then(b=>(n={element:b,emit:f},this.fire.beforeConnected&&this.fire.beforeConnected(n,!0),b)).then(b=>{if(!this.isStatic)return(h?(()=>new Promise(w=>{let _=b.getElement();_=this.$templating(h,_),this.html=b=this.Node(_),this.html.replaceDataSrc(),h=null,w()}))():Promise.resolve()).then(()=>{b.appendTo(this.root,s),this.isConnected=!0})}).then(()=>this.findTarget()).then(()=>this.findContainer()).then(()=>{let b=this.$attrib.getWatchItemsByType(this.name,"switch");for(let v=0;v<b.length;v++)this.doSwitch(b[v],i(b[v]))}).then(()=>this.addEvent(y,r)).then(()=>this.fire.isConnected&&this.fire.isConnected(n,!0)).then(()=>this.$animate("render")).then(()=>{p()})})})},e.prototype.renderAsync=function(t){this.render(t).then(()=>{this.$persist.append(this.name)})},e.prototype._smoothReset=function(){this.isConnected=!1,this.html=this.original.cloneNode()},e.prototype._hardReset=function(t){this.isConnected=!1,this.$persist.remove(t),this.html=this.original.cloneNode()},e.prototype.reset=function(){let t=this.$animate("remove");t instanceof Promise?this.await.animateRemove=new Promise(n=>{t.then(()=>this.html.remove()).then(()=>this._hardReset(this.name)).then(()=>{n()})}):(this.html.remove(this.name),this._hardReset(this.name))},e.prototype.addEvent=function(t,n){if(!!n&&!!t)return!1;let r=this.name;function s(f,y,d){return function(h){d&&h.preventDefault(),Cake.Observer.notify(y,f,h)}}if(!!this.targets){for(let f in this.targets)if(this.targets.hasOwnProperty(f)){let y=this.targets[f];for(let d of y){let{sel:h,el:p,cb:g}=d;g=g||f,p.Ref().get("__cake__events")||p.Ref().set("__cake__events",{});let b=p.Ref().get("__cake__events");if(!b[g]){let v=f.substring(0,1)!="~";p.addEventListener(f,s(g,r,v),!0),b[g]=!0,p.Ref().set("__cake__events",b)}}}}},e.prototype.findTarget=function(){let t=this.$attrib.getEventTarget(this.name),n=JSON.parse(JSON.stringify(t));for(let i of n)i.el=document.querySelector(`[data-event=${i.sel}]`),this.targets[i.event]||(this.targets[i.event]=[]),this.targets[i.event].push(i)},e.prototype.toggler=function(t){let n=this.$attrib.getWatchItemsByType(this.name,"toggle"),i=class{constructor(r,s,f,y){this.toggle=y.toggle,this.bind=r,this.bases=s,this.cache=y.$cache,this.html=f}check(r){let s=this.toggle[r];if(!s)console.error(`${r} is not found in toggle! choose from ${JSON.stringify(Object.keys(this.toggle))}`);else{if(n.length){let{ns:f}=s,y=n.find(d=>d.name==`ns-${f}`);y&&(s.sel=`[data-toggle=${y.sel}]`)}return s}}_toggle(){let r=this.check(this.bind);if(!r)return;let{basis:s="data-name",cls:f="is-active",mode:y="radio",sel:d,persist:h=!0}=r,p=this.html.querySelectorAll(d);if(!p.length)return;let g,b;if(p.length==1){let v=typeof this.bases=="boolean",w=!!this.bases,_=p[0];if(h){let O=function(S,k,C){C?S.classList.contains(k)&&S.classList.remove(k):S.classList.contains(k)||S.classList.add(k)};v?(w?(this.cache.createOrUpdate(this.bind,!0),O(_,f,!0)):(this.cache.createOrUpdate(this.bind,!1),O(_,f,!1)),_.classList.toggle(f)):(this.cache.createOrUpdate(this.bind,!_.classList.contains(f)),_.classList.toggle(f))}}else for(let v=0;v<p.length;v++){let w=p[v],_=w.classList.contains(f),O=w.getAttribute(s);O==this.bases?(y=="switch"?w.classList.toggle(f):_||w.classList.add(f),h&&this.cache.createOrUpdate(this.bind,O),b=O):_&&(w.classList.remove(f),g=w.getAttribute(s))}return{prev:g,next:b}}_recall(){let r=this.check(this.bind);if(!r)return;let{basis:s="data-name",cls:f="is-active",sel:y}=r;return this.cache.get(this.bind).then(d=>{if(!d)return d;let h=d,p=this.html.querySelectorAll(y);if(!!p.length){if(p.length==1){let g=p[0];h&&g.classList.add(f)}else for(let g=0;g<p.length;g++){let b=p[g],v=b.classList.contains(f);b.getAttribute(s)==h&&(v||b.classList.add(f))}return h}})}},u=(r,s)=>new i(r,s,this.html,this)._toggle();return u.recall=r=>new i(r,!1,this.html,this)._recall(),u},e.prototype.findContainer=function(){let t=this.html.getContainers();for(let n=0;n<t.length;n++){let i=t[n],u=i.dataset.container;u&&(this.container[u]=i)}},e.prototype._watchBindedItems=function(){this.items.length||(this.items=this.$attrib.getWatchItems(this.name),Cake.Scope.watch(this.items))},e.prototype.observer=function(t){function n(i){return this.handler[i]}this.observer=new Observer(this,t,n.bind(this))},e.prototype.variable=function(t){let n=Object.keys(t),i={},u=[];function r(s,f,y){f||(i[s]=`value is not '${y}'`)}for(let s in t)if(t.hasOwnProperty(s)){let f=t[s],{type:y,value:d}=f,h;["string","number"].includes(y)?h=typeof d==y:d instanceof Array?h=y=="array":h=y=="object",u.push(d),r(s,h,y)}if(Object.keys(i).length)throw new Error(JSON.stringify(i));return u},e}});var te=P((De,ee)=>{ee.exports=function(T){let{Attrib:m,Scope:a,Component:c,Hasher:e,Persistent:t,StorageKit:n,Observer:i,Formy:u}=T;function r(s){this.name=s,this.components={}}return r.Components=function(s){return{subscribe(f,y){function d(){let h=r.Components[s];if(h&&f instanceof Function){let p=f.name;y&&(f=f.bind(y)),f.binded="external",f.original=p,f.listenTo=h.name,h.Subscribe(f)}}return new Promise((h,p)=>{let g=setInterval(()=>{r.Components[s]&&(d(),clearInterval(g),h())})})}}},r.Models={},r.Subscribe={},r.Handlers={},r.Attributes=new m,r.Models.$loaded=function(s){return new Promise((f,y)=>{let d=setInterval(()=>{r.Models[s]&&(clearInterval(d),f(r.Models[s]))});setTimeout(()=>{r.Models[s]||(clearInterval(d),y(s))},1e4)})},r.MainMessageChannel=function(){let s=new MessageChannel;return{send(f){s.port2.postMessage(f)},receive(f){s.port1.onmessage=function(y){let{isTrusted:d,data:h}=y||{isTrusted:!1};f(d?{status:1,data:h}:{status:0,err:"not trusted!"})}}}}(),r.Utils={scopeTrap(s){return!1},scopeNotifier(s){return s}},r.create=function(s,f,y){new c(s,f,y).create(s,f,y)},r.plugin=function(){},r.init=function(s){return new c(s)},r.Scope=new a(r,{trap(s){return r.Utils.scopeTrap(s)}}),r.Hasher=new e(r.Components),r.Hasher.listen(),r.Scope.registerNotifier(function(s,f,y){return r.Attributes.notifier(s,f,y)}),r.Attributes.registerNotifier(function(s){r.Scope.notifier(s)}),r.Persistent=new t,r.Persistent.listen(r.Components),r.Cache=new n({name:"cache",storage:"session",child:"object"}),r.getSubscriber=function(s,f){let y=r.Subscribe,d={};for(let h in y)if(y.hasOwnProperty(h)){let p=y[h];for(let g in p)if(p.hasOwnProperty(g)){let b=p[g];for(let v of b){let w=v,_=w.original,O=w.binded;if(w.listenTo==s){if(_==f)if(!d[O])d[O]=f;else{let k=d[O]instanceof Array?d[O]:[d[O]];d[O]=k.concat(f)}else if(!f)if(!d[O])d[O]=_;else{let k=d[O]instanceof Array?d[O]:[d[O]];d[O]=k.concat(_)}}}}}return d},r.Cache.getAll().then(s=>{if(s instanceof Array)for(let f=0;f<s.length;f++){let y=s[f];r.Scope.watch(y)}else typeof s=="string"&&r.Scope.watch(s)}),r.Observer=new i(r.Subscribe,r.Handlers),r.prototype._defineProperty=function(s,f,y,d){Object.defineProperty(s,f,{configurable:!0,get(){return y()},set(h){d&&d(h)}})},r.prototype._defineProperty(c.prototype,"$observer",function(){return r.Observer}),r.prototype._defineProperty(c.prototype,"$scope",function(){r.Scope.install();let s=r.$scope;return Object.defineProperty(s,"extend",{configurable:!0,get(){return function(f,y){f=r.Scope.temp[f],f.toString().includes("Object")?Object.assign(f,y):console.error(`${f} is not an intance of Object`)}}}),s}),r.prototype._defineProperty(c.prototype,"$attrib",function(){return r.Attributes}),r.prototype._defineProperty(c.prototype,"$persist",function(){return r.Persistent}),r.prototype._defineProperty(c.prototype,"$cache",function(){return r.Cache}),r.prototype._defineProperty(c.prototype,"$hash",function(){return r.Hasher}),r.prototype.create=function(s,f,y){console.time(s);let d=new c(s,f,y);d.compile.then(()=>{let{subscribe:h,root:p,html:g,handlers:b,role:v}=d;return v=="form"&&function(){u.bind(d)()}(),Cakes.Observer.registerSubscribe(h).then(()=>({root:p,handlers:b}))}).then(({handlers:h,root:p})=>{r.Observer.registerHandlers(h,d.name),this._defineProperty(d,"root",function(){if(d._root)return d._root;{let g=p||"#app",b=document.querySelector(g);if(b)return b}throw new Error(`the selector '${selector}' as container of component '${d.name}' is not found!`)},function(g){Object.assign(d,{_root:g})})}).then(()=>{d.fire=function(){function h(g,b){b=b?typeof b=="function"?b.bind(d)():function(){return b}.bind(d)():null;let v={[g]:()=>b};if(fn=v[g].bind(d),typeof fn=="function"){fn.name=g,fn.original=g,fn.binded=d.name,r.Observer.registerHandlers({[g]:fn},d.name);let w=b;b&&(b.element||b.root)&&(w={status:0,message:"element cant be cloned"}),r.MainMessageChannel.send({component:d.name,event:g,payload:w});let _=r.Observer.notify(d.name,g,{}).then(()=>r.Observer.results[d.name][g]);return d.await[g]=_,d.await[g]}console.error("the param in fire is not an instance of function")}function p(g,b){for(let v in b)if(b.hasOwnProperty(v)){let w=b[v],_=w.original;Object.defineProperty(g,_,{get(){let O={[_]:function(S,k){if(k!=null&&(k=k),k==null&&_=="destroy"&&(k=!0),k==null&&(k=!1),k){let C=new Promise((A,L)=>{setTimeout(()=>{let $=S;S&&S.element&&($={status:0,message:"element cant be cloned"}),r.MainMessageChannel.send({component:d.name,event:s,payload:$}),r.Observer.notify(d.name,_,S).then(()=>r.Observer.results[d.name][_]).then(E=>{A(E)}).catch(E=>{console.error(E)})})});return d.await[_]=C,d.await[_]}else return w(S)}};return O[_]=O[_].bind(d),O[_].originalName=_,O[_].binded=d.name,O[_]}})}}return p(h,d.handlers),h}()}).then(()=>{d.type=="view"&&(d.toggler=d.toggler(d),r.Components[s]=d)}).then(()=>{d.type=="model"&&(r.Models[s]=d),d.isStatic&&d.type=="view"&&d.render()})},r}});var We=N(),Je=M(),Ke=H(),Ge=R(),Xe=U(),ie=B(),re=F(),se=x(),ne=D(),le=W(),oe=J(),ae=K(),ce=G(),he=Y(),fe=Q()({StorageKit:ie,Templating:ne}),ue=V()({Mo:le,Templating:ne,Piece,piece:re}),Ye=te()({Attrib:fe,Scope:oe,Component:ue,Hasher:ce,Persistent:ae,StorageKit:ie,Observer:se,Formy:he});})();
